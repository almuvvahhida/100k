{% extends 'base/account-base.html' %}
{% block account_base %}
    {% load static %}
    {% load humanize %}
    <style>
        .product__cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: flex-start;
            padding: 20px;
            min-width: 0;
        }

        .card {
            flex: 1 1 calc(25% - 20px);
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: scale(1.02);
        }

        .card__img img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
        }

        .modal.open {
            display: block;
        }

        .modal.close {
            display: none;
        }

        .modal__overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9998;
        }

        .modal__content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            z-index: 9999;
        }

        .modal__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .select-modal__close-icon {
            cursor: pointer;
            width: 24px;
            height: 24px;
        }
    </style>
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta name="theme-color" content="#000000">
        <meta name="description" content="Advertiserlar uchun admin panel">
        <link rel="manifest" href="https://admin.100k.uz/manifest.json">
        <link rel="apple-touch-icon" href="https://admin.100k.uz/logo192.png">
        <link rel="stylesheet" href="{% static 'market_files/all.min.css' %}">
        <link href="{% static 'market_files/main.bbfc6021.css' %}" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/154.45bd50c0.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/88.3f709be3.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/905.a466c525.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/164.8fd4a5f2.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/48.01f17801.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/379.a6858002.chunk.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'market_files/661.9db8dfee.chunk.css' %}">
        <style data-emotion="css" data-s=""></style>
    </head>
    <body>
    <div id="root">
        <div class="app" style="position: relative;">
            <div class="layout">
                <div class="page-wrapper">
                    <main class="page-content">
                        <div class="market">
                            <div class="container">
                                <div class="mantine-12semsw"></div>
                                <div class="block-info"><span>Maxsulot reklamasini olish uchun <a
                                        href="https://t.me/yuzkabot" target="_blank" rel="noreferrer"
                                        style="text-decoration: underline;">@yuzkabot</a> telegram botga ulaning.</span>
                                </div>
                                <h3>Hozirda sotuvda bor mahsulotlar</h3>
                                <div class="mantine-1qtpduh"></div>
                                <div class="filter-wrapper">
                                    <form>
                                        <div class="form-group"><label class="form-label " for="select"></label>
                                            <div class="select css-b62m3t-container"><span
                                                    id="react-select-4-live-region"
                                                    class="css-7pg0cj-a11yText"></span><span
                                                    aria-live="polite" aria-atomic="false"
                                                    aria-relevant="additions text"
                                                    class="css-7pg0cj-a11yText"></span>
                                                <div class="select__control css-13cymwt-control">
                                                    <div class="select__value-container css-hlgwow">
                                                        <div class="select__placeholder css-1jqq78o-placeholder"
                                                             id="react-select-4-placeholder">Sotuvchini tanlang
                                                        </div>
                                                        <div class="select__input-container css-19bb58m" data-value="">
                                                            <input class="select__input" autocapitalize="none"
                                                                   autocomplete="off" autocorrect="off"
                                                                   id="react-select-4-input" spellcheck="false"
                                                                   tabindex="0"
                                                                   type="text" aria-autocomplete="list"
                                                                   aria-expanded="false" aria-haspopup="true"
                                                                   role="combobox"
                                                                   aria-describedby="react-select-4-placeholder"
                                                                   value=""
                                                                   style="color: inherit; background: 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px; margin: 0px; outline: 0px; padding: 0px;">
                                                        </div>
                                                    </div>
                                                    <div class="select__indicators css-1wy0on6"><span
                                                            class="select__indicator-separator css-1u9des2-indicatorSeparator"></span>
                                                        <div class="select__indicator select__dropdown-indicator css-1xc3v61-indicatorContainer"
                                                             aria-hidden="true">
                                                            <svg height="20" width="20" viewBox="0 0 20 20"
                                                                 aria-hidden="true" focusable="false"
                                                                 class="css-8mmkcg">
                                                                <path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path>
                                                            </svg>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="form__error"></p></div>
                                    </form>
                                    <div class="form-group">
                                        <div class="search-wrap">
                                            <button class="mantine-UnstyledButton-root mantine-Button-root icon mantine-1ke2qfb"
                                                    type="button" data-button="true">
                                                <div class="mantine-3xbgk5 mantine-Button-inner"><span
                                                        class="mantine-qo1k2 mantine-Button-label"><svg
                                                        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path
                                                        d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path></svg></span>
                                                </div>
                                            </button>
                                            <input type="text" class="form-control " autocomplete="off" maxlength="255"
                                                   name="query" value="">
                                            <button class="mantine-UnstyledButton-root mantine-Button-root submit mantine-8nr514"
                                                    type="submit" data-button="true">
                                                <div class="mantine-3xbgk5 mantine-Button-inner"><span
                                                        class="mantine-qo1k2 mantine-Button-label">Izlash</span></div>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="mantine-1q1idfv"></div>
                                <div class="categories">
                                    <div class="categories-item {% if current_category == 'Yangi' %}active{% endif %}"
                                         onclick="window.location.href='{% url 'category_filter' 'Yangi' %}'">Yangi 🕒
                                    </div>
                                    <div class="categories-item {% if current_category == 'TOP' %}active{% endif %}"
                                         onclick="window.location.href='{% url 'category_filter' 'TOP' %}'">TOP ⭐
                                    </div>
                                    <div class="categories-item {% if current_category == 'Zaxira' %}active{% endif %}"
                                         onclick="window.location.href='{% url 'category_filter' 'Zaxira' %}'">Zaxira
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                             xmlns="http://www.w3.org/2000/svg" class="arrow-up"
                                             style="display: block; width: 18px; height: 18px; rotate: 90deg;">
                                            <path d="M7.82843 10.9999H20V12.9999H7.82843L13.1924 18.3638L11.7782 19.778L4 11.9999L11.7782 4.22168L13.1924 5.63589L7.82843 10.9999Z"
                                                  fill="#2F8AF5"></path>
                                        </svg>
                                    </div>
                                    <div class="categories-item {% if current_category == 'Yuqori Sotuv' %}active{% endif %}"
                                         onclick="window.location.href='{% url 'category_filter' 'Yuqori Sotuv' %}'">
                                        Yuqori
                                        Sotuv
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                                             class="icon-percent"
                                             style="display: block; width: 14px; height: 14px;">
                                            <path d="M96 224c53 0 96-43 96-96s-43-96-96-96S0 75 0 128s43 96 96 96zm0-144c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zm192 208c-53 0-96 43-96 96s43 96 96 96 96-43 96-96-43-96-96-96zm0 144c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm93.9-381.2L57.2 475c-2.3 3.1-5.9 5-9.7 5H12c-9.6 0-15.3-10.7-10-18.7L327.2 37c2.3-3.1 5.9-5 9.7-5H372c9.6 0 15.3 10.8 9.9 18.8z"></path>
                                        </svg>
                                    </div>
                                    {% for category in categories %}
                                        <div class="categories-item {% if current_category == category.name %}active{% endif %}"
                                             onclick="window.location.href='{% url 'category_filter' category.name %}'">{{ category.name }}</div>
                                    {% endfor %}
                                </div>
                                {# Product Cards #}
                                <div class="product__cards">
                                    {% if no_products %}
                                        <p>No products found for this category.</p>
                                    {% else %}
                                        {% for product in products %}
                                            <div class="card">
                                                <a href="{% url 'product_detail' product.pk %}">
                                                    <div class="card__img">
                                                        <img src="{{ product.main_image.url }}" alt="">
                                                        <div class="rating">
                                                            <svg viewBox="0 0 24 24" stroke-linecap="round"
                                                                 stroke-linejoin="round" fill="none"
                                                                 xmlns="http://www.w3.org/2000/svg"
                                                                 class="mantine-1jqub9a">
                                                                <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                                                            </svg>
                                                            <span>5</span>
                                                        </div>
                                                    </div>
                                                </a>
                                                <ul>
                                                    <li><a href="{% url 'product_detail' product.pk %}">
                                                        <h2 class="c-red">{{ product.name }}</h2></a>
                                                        <p class="price mr-10">{{ product.discount_price|floatformat:'0'|intcomma }}
                                                            so'm</p>
                                                        <p class="ml-2" style="font-size: 12px;">Reklama</p>
                                                        образование
                                                    <li>To'lov:
                                                        <strong>{{ product.bonus_price|default:'0'|intcomma }}
                                                            so'm</strong></li>
                                                    <li><a href="https://t.me/jonik_admin" target="_blank"
                                                           rel="noreferrer"
                                                           class="store-link">Sotuvchi:
                                                        <strong>{{ product.seller.name }}</strong></a>
                                                    </li>
                                                    <li>Zaxirada: <span
                                                            class="c-green">{{ product.quantity }} ta </span>
                                                    </li>
                                                    <li>
                                                        <div class="" data-tooltipped=""
                                                             aria-describedby="tippy-tooltip-28"
                                                             data-original-title="Jami buyurtmalar: 534 ta"
                                                             style="display: inline;">
                                                            <div class="f-c">
                                                                <svg width="20" height="20" viewBox="0 0 20 20"
                                                                     fill="none"
                                                                     xmlns="http://www领区
                                                                    <g opacity=" 0.7
                                                                " clip-path="url(#clip0_213_20219)">
                                                                <path d="M9.99935 18.3333C5.39685 18.3333 1.66602 14.6025 1.66602 10C1.66602 5.39751 5.39685 1.66667 9.99935 1.66667C14.6018 1.66667 18.3327 5.39751 18.3327 10C18.3327 14.6025 14.6018 18.3333 9.99935 18.3333ZM9.16602 9.16667V14.1667H10.8327V9.16667H9.16602ZM9.16602 5.83334V7.5H10.8327V5.83334H9.16602Z"
                                                                      fill="#293462"></path>
                                                                </g>
                                                                <defs>
                                                                    <clippath id="clip0_213_20219">
                                                                        <rect width="20" height="20"
                                                                              fill="white"></rect>
                                                                    </clippath>
                                                                </defs>
                                                                </svg>
                                                                Sotilish foizi: <span class="c-green ml-1">30% </span>
                                                            </div>
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                                             xmlns="http://www.w3.org/2000/svg">
                                                            <path d="M14 4.4375C15.3462 4.4375 16.4375 3.34619 16.4375 2H17.5625C17.5625 3.34619 18.6538 4.4375 20 4.4375V5.5625C18.6538 5.5625 17.5625 6.65381 17.5625 8H16.4375C16.4375 6.65381 15.3462 5.5625 14 5.5625V4.4375ZM1 11C4.31371 11 7 8.31371 7 5H9C9 8.31371 11.6863 11 15 11V13C11.6863 13 9 15.6863 9 19H7C7 15.6863 4.31371 13 1 13V11ZM17.25 14C17.25 15.7949 15.7949 17.25 14 17.25V18.75C15.7949 18.75 17.25 20.2051 17.25 22H18.75C18.75 20.2051 20.2051 18.75 22 18.75V17.25C20.2051 17.25 18.75 15.7949 18.75 14H17.25Z"
                                                                  fill="#9747FF"></path>
                                                        </svg>
                                                        Kreativlar: <strong class="c-blue cp">Ko‘rsatish</strong>
                                                    </li>
                                                    <li><p class="c-red c-pointer" style="opacity: 1;">👉 Reklama
                                                        posti</p>
                                                    </li>
                                                    <li>
                                                        <button
                                                                class="create-stream-btn"
                                                                data-product-id="{{ product.id }}"
                                                                data-product-name="{{ product.name }}">
                                                            Oqim yaratish
                                                        </button>

                                                    </li>
                                                </ul>
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>
        </div>
        <div style="position: fixed; z-index: 9999; inset: 16px; pointer-events: none;"></div>
    </div>
    <div id="modal">
        <div class="modal close modal-create-stream">
            <div class="modal__overlay"></div>
            <div class="modal__content" style="max-width: 500px;">
                <div class="modal__box">
                    <div class="modal__header">
                        <p class="modal__title">Oqim yaratish</p>
                        <div style="padding: 10px;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                                 class="select-modal__close-icon"
                                 style="cursor: pointer;">
                                <path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path>
                            </svg>
                        </div>
                    </div>

                    <div class="stream-create">
                        <form action="{% url 'stream_create' %}" method="post">
                            {% csrf_token %}
                            <div class="form-group">
                                <label class="form-label required" for="input">Oqim nomi</label>
                                <input name="name" type="text" class="form-control" autocomplete="off"
                                       maxlength="255">
                                <input name="product" type="hidden" id="hidden_product">
                                <input name="owner" type="hidden" id="hidden_owner" value="{{ request.user.pk }}">
                                <p class="form__error"></p>
                            </div>
                            <br>
                            <div class="form-group undefined">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox">
                                    <label class="form-check-label" for="remember">Buyurtmalarni operatorsiz qabul
                                        qilish?</label>
                                </div>
                            </div>
                            <br>
                            <span><span class="c-red">Bepul yetkazish butunlay olib tashlandi!</span></span>
                            <div class="btn-group">
                                <button class="btn_open_modal" type="submit" name="3" data-product-name="Product 3">Oqim
                                    yaratish
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal modal-create-stream close copy-stream">
        <div class="modal__overlay"></div>
        <div class="modal__content" style="max-width: 500px;">
            <div class="modal__box">
                <div class="modal__header">
                    <p class="modal__title">Oqimdan nusxa olish</p>
                    <div style="padding: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                             class="select-modal__close-icon"
                             style="cursor: pointer;">
                            <path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path>
                        </svg>
                    </div>
                </div>
                <div class="p-16">
                    <p class="info">Oqim yaratildi! Quyidagi tugma orqali "link" nusxasini ko'chirib oling.</p>
                    <form>
                        <div class="form-group">
                            <label class="form-label" for="input">Oqim nomi</label>
                            <input name="link" type="text" class="form-control" autocomplete="off" maxlength="255"
                                   disabled>
                            <p class="form__error"></p>
                        </div>
                        <div class="center">
                            <button type="button" class="btn btn-primary">Nusxa ko'chirish</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal close modal-news modal-product-post">
        <div class="modal__overlay"></div>
        <div class="modal__content">
            <div class="modal__box">
                <div class="modal__header">
                    <p class="modal__title"></p>
                    <div style="padding: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                             class="select-modal__close-icon"
                             style="cursor: pointer;">
                            <path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path>
                        </svg>
                    </div>
                </div>
                <div class="box">
                    <div class="f-c-sb">
                        <h2>Adminlar uchun kreativlar</h2>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="modal-x-icon">
                            <path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path>
                        </svg>
                    </div>
                    <h4 class="mt-30">Qo‘shimcha videolar</h4>
                    <div class="posts">
                        <div class="product-post-card">
                            <div class="left w-full"><p class="sk icon"></p>
                                <div class="content w-full"><p class="title sk mb-1 w-30"></p>
                                    <p class="size sk w-70"></p></div>
                            </div>
                            <div class="right"><p class="sk icon"></p>
                                <p class="sk icon"></p></div>
                        </div>
                        <div class="product-post-card">
                            <div class="left w-full"><p class="sk icon"></p>
                                <div class="content w-full"><p class="title sk mb-1 w-30"></p>
                                    <p class="size sk w-70"></p></div>
                            </div>
                            <div class="right"><p class="sk icon"></p>
                                <p class="sk icon"></p></div>
                        </div>
                        <div class="product-post-card">
                            <div class="left w-full"><p class="sk icon"></p>
                                <div class="content w-full"><p class="title sk mb-1 w-30"></p>
                                    <p class="size sk w-70"></p></div>
                            </div>
                            <div class="right"><p class="sk icon"></p>
                                <p class="sk icon"></p></div>
                        </div>
                        <div class="product-post-card">
                            <div class="left w-full"><p class="sk icon"></p>
                                <div class="content w-full"><p class="title sk mb-1 w-30"></p>
                                    <p class="size sk w-70"></p></div>
                            </div>
                            <div class="right"><p class="sk icon"></p>
                                <p class="sk icon"></p></div>
                        </div>
                    </div>
                </div>
                <div class="close-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                        <path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <div id="select-menus"></div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es5%2Ces6%2Ces7%2CString.prototype.replaceAll%2CSymbol.replace"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const createStreamButtons = document.querySelectorAll('.create-stream-btn');
            const createStreamModal = document.querySelector('.modal-create-stream');
            const closeModalIcon = createStreamModal.querySelector('.select-modal__close-icon');
            const modalOverlay = createStreamModal.querySelector('.modal__overlay');
            const modalTitle = createStreamModal.querySelector('.modal__title');
            const hiddenProductInput = document.getElementById('hidden_product');

            function openModal(event) {
                const button = event.currentTarget;
                const productName = button.getAttribute('data-product-name');
                const productId = button.getAttribute('data-product-id');

                modalTitle.textContent = `${productName} - Oqim yaratish`;

                hiddenProductInput.value = productId;

                createStreamModal.classList.remove('close');
                createStreamModal.classList.add('open');
            }

            function closeModal() {
                createStreamModal.classList.add('close');
                createStreamModal.classList.remove('open');
            }

            // Tugmalarga click event biriktirish
            createStreamButtons.forEach(button => {
                button.addEventListener('click', openModal);
            });

            // Close icon va overlay orqali yopish
            closeModalIcon.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', closeModal);
        });
    </script>

    </body>
{% endblock %}